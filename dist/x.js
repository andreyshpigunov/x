var z=Object.defineProperty;var D=(r,e,t)=>e in r?z(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var T=(r,e,t)=>D(r,typeof e!="symbol"?e+"":e,t);const HAS_DOM=()=>typeof document<"u"&&typeof window<"u";class Lib{constructor(){this.loadedScripts=new Set,HAS_DOM()&&this._elementRender()}_elementRender(){HAS_DOM()&&document.addEventListener("DOMContentLoaded",()=>{const elements=this.qsa("[x-render]");for(let i=0;i<elements.length;i++){const item=elements[i];try{const expression=item.getAttribute("x-render");if(expression){const value=eval(expression);this.render(item,value)}}catch(r){}}},{once:!0})}_escapeHtml(r){if(r==null)return"";const e=String(r);if(HAS_DOM()){const t=document.createElement("div");return t.textContent=e,t.innerHTML}return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}id(r){return HAS_DOM()?document.getElementById(r):null}qs(r,e=document){return r?HAS_DOM()?typeof r=="string"?e.querySelector(r):r instanceof Node?r:r instanceof NodeList?r.length?r[0]:null:Array.isArray(r)&&r.length?r[0]instanceof Node?r[0]:e.querySelector(r[0]):r===window?r:null:r instanceof Node?r:null:null}qsa(r,e=document){if(!r)return[];if(!HAS_DOM())return r instanceof Node?[r]:[];if(typeof r=="string")return Array.from(e.querySelectorAll(r));if(r instanceof NodeList)return Array.from(r);if(r instanceof Node)return[r];if(Array.isArray(r)&&r.length){const t=[];for(let s=0;s<r.length;s++){const n=r[s];n instanceof Node?t.push(n):n instanceof NodeList?t.push(...n):t.push(...e.querySelectorAll(n))}return t.flat()}return r===window?[r]:[]}async hide(r){await this.addClass(r,"hidden")}async show(r){await this.removeClass(r,"hidden")}async toggle(r){await this.toggleClass(r,"hidden")}async switch(r,e){e?await this.removeClass(r,"hidden"):await this.addClass(r,"hidden")}async addClass(r,e,t=0){const s=this.qsa(r),n=s.length;if(n){if(t>0){const o=e.replace(/--.*/,"")+"--ready";for(let l=0;l<n;l++)s[l].classList.add(o);await new Promise(l=>setTimeout(l,t))}for(let o=0;o<n;o++)s[o].classList.add(e)}}async removeClass(r,e,t=0){const s=this.qsa(r),n=s.length;if(n){for(let o=0;o<n;o++)s[o].classList.remove(e);if(t>0){await new Promise(l=>setTimeout(l,t));const o=e.replace(/--.*/,"")+"--ready";for(let l=0;l<n;l++)s[l].classList.remove(o)}}}async toggleClass(r,e,t=0){const s=this.qsa(r),n=s.length;for(let o=0;o<n;o++){const l=s[o];l.classList.contains(e)?await this.removeClass(l,e,t):await this.addClass(l,e,t)}}async switchClass(r,e,t,s=0){t?await this.addClass(r,e,s):await this.removeClass(r,e,s)}reload(){typeof window>"u"||location.reload()}reloadWithHash(r){typeof window>"u"||(location.hash=r,this.reload())}redirectTo(r){typeof window>"u"||(location.href=r)}updateURL(r,e){typeof window>"u"||(history.pushState?history.pushState(null,e,r):location.href=r)}random(r,e){return Math.floor(Math.random()*(e-r+1))+r}price(r){return parseFloat(r).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$& ").replace(".00","")}number(r){const e=(r+"").split(".");return e[0]=e[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 "),e.join(".")}numberDecline(r,e,t,s){if(r>10&&Math.floor(r%100/10)===1)return s;switch(r%10){case 1:return e;case 2:case 3:case 4:return t;default:return s}}isEmail(r){return typeof r!="string"?!1:/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(r.trim())}isValidJSON(r){if(typeof r!="string")return!1;try{return JSON.parse(r),!0}catch{return!1}}isInteger(r){const e=Number(r);return Number.isInteger(e)}isDouble(r){const e=Number(r);return!isNaN(e)&&typeof e=="number"}makeId(){return"id"+this.random(1e5,999999)}makePassword(r=8,e){r<1&&(r=8);const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#^$%^&*()-+:,.;_";let s="";for(let n=0;n<r;n++)s+=t[Math.floor(Math.random()*t.length)];if(e){const n=this.qs(e);n&&"value"in n&&(n.value=s);return}return s}loadScript(r,e,t="async"){if(!(!HAS_DOM()||!r||typeof e!="function")){try{if(typeof r=="string"&&r.startsWith("http")){const s=new URL(r,window.location.href);if(s.protocol!=="http:"&&s.protocol!=="https:")return}}catch{if(!r.startsWith("/")&&!r.startsWith("./")&&!r.startsWith("../"))return}if(this.loadedScripts.has(r)){e();return}try{const s=document.createElement("script");s.onload=e,s.onerror=()=>this.loadedScripts.delete(r),s.src=r,t&&s.setAttribute(t,""),s.crossOrigin="anonymous",document.body.appendChild(s),this.loadedScripts.add(r)}catch{}}}deferred(r,e=1e4){if(typeof window>"u")return;const t=["scroll","resize","click","keydown","mousemove","touchmove"];let s;const n=()=>{for(let o=0;o<t.length;o++)window.removeEventListener(t[o],n,{once:!0});document.readyState==="complete"?r():window.addEventListener("load",r,{once:!0}),clearTimeout(s)};s=setTimeout(n,e);for(let o=0;o<t.length;o++)window.addEventListener(t[o],n,{once:!0})}deffered(r,e=1e4){return this.deferred(r,e)}throttle(r,e,t={}){return this._throttle(r,e,t)}debounce(r,e,t={}){return this._debounce(r,e,t)}onAppear(r,e,t=null,s={}){if(!HAS_DOM()||typeof e!="function"||!("IntersectionObserver"in window))return;const n=this.qsa(r),o=n.length;if(!o)return;const l=new IntersectionObserver((a,c)=>{for(let h=0;h<a.length;h++){const u=a[h];u.isIntersecting?(e(u.target),t||c.unobserve(u.target)):t&&t(u.target)}},{root:null,rootMargin:"200px",threshold:.1,...s});for(let a=0;a<o;a++)l.observe(n[a])}alertErrors(r){r&&alert(typeof r=="string"?r:Object.values(r).join(`
`))}printErrors(r){return r?typeof r=="string"?`<div>${this._escapeHtml(r)}</div>`:Object.entries(r).map(([e,t])=>{const s=this._escapeHtml(String(e)),n=this._escapeHtml(String(t));return`<div class="error_${s}">${n}</div>`}).join(`
`):""}async render(r,e,t=null,s=!1){var l,a;if(!r)return;const n=this.qsa(r),o=n.length;if(o)try{const c=typeof e=="function"?await e():e,h=String(c||"");for(let u=0;u<o;u++){const d=n[u];if(s)if(t==null)d.textContent=h;else{const p=document.createTextNode(h);t==="beforebegin"?(l=d.parentNode)==null||l.insertBefore(p,d):t==="afterbegin"?d.insertBefore(p,d.firstChild):t==="beforeend"?d.appendChild(p):t==="afterend"&&((a=d.parentNode)==null||a.insertBefore(p,d.nextSibling))}else t==null?d.innerHTML=h:d.insertAdjacentHTML(t,h)}}catch{}}transitionsOn(r=0){HAS_DOM()&&setTimeout(()=>document.documentElement.classList.remove("noTransitions"),r)}transitionsOff(){HAS_DOM()&&document.documentElement.classList.add("noTransitions")}async sleep(r){return new Promise(e=>setTimeout(e,r))}_throttle(r,e,t={}){let s=null,n=null,o=null,l=0;const{leading:a=!0,trailing:c=!0}=t,h=d=>{l=d,r.apply(o,n),n=o=null},u=function(...d){const p=Date.now();!l&&!a&&(l=p),n=d,o=this;const b=e-(p-l);b<=0||b>e?(s&&clearTimeout(s),s=null,h(p)):!s&&c&&(s=setTimeout(()=>{s=null,c&&n&&h(Date.now())},b))};return u.cancel=()=>{s&&clearTimeout(s),s=n=o=null,l=0},u}_debounce(r,e,t={}){let s=null,n=null,o=null;const{leading:l=!1,trailing:a=!0}=t,c=()=>{r.apply(o,n),n=o=null},h=function(...u){n=u,o=this,s&&clearTimeout(s),l&&!s&&c(),s=setTimeout(()=>{s=null,a&&n&&c()},e)};return h.cancel=()=>{s&&clearTimeout(s),s=n=o=null},h}}const lib=new Lib;class Modal{constructor(){this.modalLevel=0,this.lockCount=0,this.html=null,this._initialized=!1,this._clickHandler=null,this._keydownHandler=null}init(){typeof document>"u"||typeof window>"u"||(this._initialized&&this.destroy(),this.html=lib.qs("html"),this._renderModalContents(),this._setupModalLinks(),this._setupGlobalListeners(),this._initialized=!0)}destroy(){typeof document>"u"||(this._clickHandler&&(document.removeEventListener("click",this._clickHandler),this._clickHandler=null),this._keydownHandler&&(document.removeEventListener("keydown",this._keydownHandler),this._keydownHandler=null),this.modalLevel=0,this.lockCount=0,this.html=null,this._initialized=!1)}_isValidId(e){return typeof e!="string"||!e?!1:/^[a-zA-Z0-9_-]+$/.test(e)}_escapeHtml(e){if(e==null)return"";const t=String(e);if(typeof document<"u"){const s=document.createElement("div");return s.textContent=t,s.innerHTML}return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}_renderModalContents(){const e=lib.qsa("[x-modal]"),t=lib.qs(".modal-here")||lib.qs("body");if(t)for(let s=0;s<e.length;s++){const n=e[s],o=n.getAttribute("x-modal");if(!o||!this._isValidId(o)||lib.qs("#"+o))continue;const l=n.getAttribute("class")||"",a=(n.getAttribute("data-window-class")||"").replace(/\s+/g," ").trim(),c=this._escapeHtml(a),h=n.innerHTML,u=document.createElement("div");u.id=o,u.className="modal "+l,u.innerHTML='<div class="modal-overlay"></div><div class="modal-outer"><div class="modal-inner"><div class="modal-window '+c+'">'+h+'<div class="modal-rail"><a role="button" class="modal-close"></a></div></div></div></div>',t.appendChild(u),n.remove()}}_setupModalLinks(){const e=lib.qsa("[x-modal-open]");for(let t=0;t<e.length;t++){const s=e[t],n=s.getAttribute("x-modal-open");if(!(!n||!this._isValidId(n))&&(s.addEventListener("click",o=>{o.preventDefault(),this.show(n)}),window.location.hash==="#"+n)){const o=lib.qs("#"+n);o&&o.classList.contains("modal--hash")&&this.show(n)}}}_setupGlobalListeners(){this._clickHandler=e=>{if(!lib.qs(".modal--active"))return;const t=e.target,s=t.classList&&t.classList.contains("modal-close"),n=!t.closest||!t.closest(".modal-window");if(!s&&!n)return;e.preventDefault();const o=t.closest(".modal"),l=o?o.getAttribute("id"):null;l&&this._isValidId(l)&&this.hide(l)},this._keydownHandler=e=>{if(e.key!=="Escape")return;const t=lib.qsa(".modal--active"),s=t.length;if(!s)return;const n=t[s-1].getAttribute("id");n&&this._isValidId(n)&&(e.preventDefault(),this.hide(n))},document.addEventListener("click",this._clickHandler),document.addEventListener("keydown",this._keydownHandler)}async show(e){if(typeof document>"u"||!e||typeof e!="string"||!this._isValidId(e)||this.lockCount>0)return;if(this.isActive(e)){await this.hide(e);return}const t=lib.qs("#"+e);if(t){t.classList.contains("modal--uniq")&&await this.hideAll(),this.lockCount++;try{await lib.addClass(t,"modal--ready"),await lib.sleep(10),t.dispatchEvent(new CustomEvent("modal:ready")),t.classList.contains("modal--hash")&&history.replaceState(null,"","#"+e),this.html&&(lib.addClass(this.html,"modal--active"),lib.addClass(this.html,e+"--active")),lib.addClass("[x-modal-open="+e+"]","active"),this.modalLevel++,lib.addClass(t,"modal--z"+this.modalLevel),await lib.addClass(t,"modal--active");const s=lib.qs(".modal-outer",t);s&&s.scrollTo(0,1),await lib.sleep(200),t.dispatchEvent(new CustomEvent("modal:open"))}catch{}finally{this.lockCount--}}}async hide(e){if(typeof document>"u"||!e||typeof e!="string"||!this._isValidId(e)||this.lockCount>0)return;const t=lib.qs("#"+e);if(t){this.lockCount++;try{t.classList.contains("modal--hash")&&window.location.hash==="#"+e&&history.replaceState(null,document.title,window.location.pathname+window.location.search),lib.removeClass("[x-modal-open="+e+"]","active"),await lib.removeClass(t,"modal--active",200),lib.removeClass(t,"modal--z"+this.modalLevel),t.dispatchEvent(new CustomEvent("modal:close")),this.html&&lib.removeClass(this.html,e+"--active"),this.modalLevel--,this.modalLevel===0&&this.html&&lib.removeClass(this.html,"modal--active")}catch{}finally{this.lockCount--}}}async hideAll(){if(typeof document>"u")return;const e=lib.qsa(".modal--active");for(let t=0;t<e.length;t++){const s=e[t].getAttribute("id");s&&await this.hide(s)}}isActive(e){if(typeof document>"u"||!e||typeof e!="string"||!this._isValidId(e))return!1;const t=lib.qs("#"+e);return t?t.classList.contains("modal--active"):!1}}const modal=new Modal;class Animate{constructor(){this._ticking=!1,this._animations=[],this._scroll=this._scroll.bind(this),this._scrollHandler=this._scrollHandler.bind(this),this._initialized=!1,this._parents=new Set,this._elements=null}init(){var e;typeof window>"u"||(this._cleanup(),this._elements=lib.qsa("[x-animate]"),(e=this._elements)!=null&&e.length&&(this._parseElementsAnimations(),this._animations.length&&(this._setupListeners(),this._initialized=!0)))}_cleanup(){this._initialized&&(typeof window>"u"||(this._parents.forEach(e=>{e.removeEventListener("scroll",this._scrollHandler)}),window.removeEventListener("resize",this._scrollHandler),this._ticking=!1,this._animations=[],this._parents=new Set,this._elements=null,this._initialized=!1))}destroy(){typeof window>"u"||this._cleanup()}_parseElementsAnimations(){this._animations=[];for(const e of this._elements)try{const t=JSON.parse(e.getAttribute("x-animate"));this._animations.push({element:e,trigger:lib.qs(t.trigger)||e,parent:lib.qs(t.parent)||window,start:t.start,end:t.end||!1,class:t.class,classRemove:t.classRemove!==!1,functionName:t.functionName,fn:null,lockedIn:!1,lockedOut:!1,log:t.log||!1})}catch(t){console.error("Invalid JSON in x-animate attribute:",e,t)}}_setupListeners(){for(const t of this._animations)this._parents.has(t.parent)||(this._parents.add(t.parent),t.parent.addEventListener("scroll",this._scrollHandler));window.addEventListener("resize",this._scrollHandler);const e=()=>requestAnimationFrame(()=>this._scroll());document.readyState==="complete"?e():window.addEventListener("load",e,{once:!0})}_scrollHandler(){this._ticking||(this._ticking=!0,window.requestAnimationFrame(()=>{this._scroll(),this._ticking=!1}))}_scroll(){for(let e=0;e<this._animations.length;e++){const t=this._animations[e];if(!t.element.isConnected||!t.trigger.isConnected)continue;!t.fn&&t.functionName&&typeof window[t.functionName]=="function"&&(t.fn=window[t.functionName]);const s=t.trigger.getBoundingClientRect(),n=t.parent,o=n===window?0:n.getBoundingClientRect().top,l=s.top-o,a=this._2px(t.start,n),c=this._2px(t.end,n),h=!isNaN(a),u=!isNaN(c),d=t.fn;t.log&&console.log(l,a,c,t),h&&u?(t.duration=a-c,l<=a&&l>=c?(t.lockedOut=!1,t.class&&!t.element.classList.contains(t.class)&&t.element.classList.add(t.class),d&&(t.progress=((a-l)/t.duration).toFixed(4),d(t))):(t.class&&t.classRemove&&t.element.classList.contains(t.class)&&t.element.classList.remove(t.class),!t.lockedOut&&d&&(l>=a?(t.progress=0,d(t),t.lockedOut=!0):l<=c&&(t.progress=1,d(t),t.lockedOut=!0)))):h&&(l<=a?(t.lockedOut=!1,t.class&&!t.element.classList.contains(t.class)&&t.element.classList.add(t.class),!t.lockedIn&&d&&(t.progress=1,d(t),t.lockedIn=!0)):(t.lockedIn=!1,t.class&&t.classRemove&&t.element.classList.contains(t.class)&&t.element.classList.remove(t.class),!t.lockedOut&&d&&l>=a&&(t.progress=0,d(t),t.lockedOut=!0)))}}_2px(e,t=window){if(typeof e=="number")return e;if(typeof e!="string")return NaN;const s=parseFloat(e);return/[%vh]/.test(e)?(e.includes("vh")||t===window?document.documentElement.clientHeight:t.clientHeight)*s/100:s}}const animate=new Animate;class Appear{constructor(){this._targets=[],this._observer=null,this._options={appearedClass:"appeared",visibleClass:"visible",once:!1,root:null,rootMargin:"0px",threshold:0},this._observerCallback=this._observerCallback.bind(this)}init(e={}){if(typeof window>"u"||!("IntersectionObserver"in window)||(this._options={...this._options,...e},this._observer&&(this._observer.disconnect(),this._observer=null),this._targets=lib.qsa("[x-appear]"),!this._targets.length))return;const{root:t,rootMargin:s,threshold:n}=this._options;this._observer=new IntersectionObserver(this._observerCallback,{root:t||null,rootMargin:s,threshold:n});for(let o=0;o<this._targets.length;o++)this._observer.observe(this._targets[o])}destroy(){typeof window>"u"||(this._observer&&(this._observer.disconnect(),this._observer=null),this._targets=[])}_observerCallback(e){const{appearedClass:t,visibleClass:s,once:n}=this._options,o=this._observer;for(let l=0;l<e.length;l++){const a=e[l],c=a.target;a.isIntersecting?(t&&!c.classList.contains(t)&&(c.classList.add(t),n&&o&&o.unobserve(c)),s&&!c.classList.contains(s)&&(c.classList.add(s),c.dispatchEvent(new CustomEvent("visible",{detail:{appeared:!0}})))):s&&c.classList.contains(s)&&(c.classList.remove(s),c.dispatchEvent(new CustomEvent("invisible",{detail:{appeared:!0}})))}}}const appear=new Appear;class Lazyload{constructor(){this._observer=null,this._options={root:null,rootMargin:"200px",threshold:.1}}init(){if(typeof window>"u"||typeof document>"u"||!("IntersectionObserver"in window))return;this._observer||(this._observer=new IntersectionObserver(this._callback.bind(this),this._options));const e=lib.qsa("[x-lazyload]");for(let t=0;t<e.length;t++){const s=e[t];s.classList.contains("loaded")||this._observer.observe(s)}}destroy(){typeof window>"u"||this._observer&&(this._observer.disconnect(),this._observer=null)}_callback(e){for(let t=0;t<e.length;t++){const s=e[t];!s.isIntersecting||!s.target||this._loadImage(s.target)}}_fetchImage(e,t){return new Promise((s,n)=>{if(!e&&!t){n(new Error("lazyload: no src or srcset"));return}const o=new Image;o.onload=s,o.onerror=()=>n(new Error("lazyload: load failed")),t&&(o.srcset=t),e&&(o.src=e)})}_loadImage(e){if(!e||e.nodeName!=="IMG")return;const t=e.getAttribute("data-src"),s=e.getAttribute("data-srcset");if(!t&&!s){this._observer&&this._observer.unobserve(e);return}const n=this._observer;this._fetchImage(t||null,s||null).then(()=>{s&&(e.srcset=s,e.removeAttribute("data-srcset")),t&&(e.src=t,e.removeAttribute("data-src")),e.classList.add("loaded"),n&&n.unobserve(e)}).catch(()=>{n&&n.unobserve(e)})}}const lazyload=new Lazyload;class Loadmore{constructor(){this.items={},this.locked=!1,this.observer=null,this._initialized=!1}init(){if(typeof window>"u"||typeof document>"u")return;this._initialized&&this.destroy();const e=lib.qsa("[x-loadmore]"),t=e.length;if(!t)return;const s=/^[a-zA-Z_$][a-zA-Z0-9_$.]*$/,n=async(o,l)=>{for(let a=0;a<o.length;a++){const c=o[a];if(!(!c.isIntersecting||this.locked)){this.locked=!0;try{const h=c.target;if(!h)continue;const u=h.getAttribute("x-loadmore");if(!u)continue;let d;try{d=JSON.parse(u)}catch{continue}const p=d&&d.functionName;if(typeof p!="string"||!s.test(p))continue;const b=window[p];if(typeof b!="function")continue;const E=h.id,_=E?this.items[E]:null;if(!_)continue;const C=_.page||1,A=await b(C);A===!0?_.page=C+1:A===!1&&l.unobserve(h)}catch{}finally{this.locked=!1}}}};if("IntersectionObserver"in window){this.observer=new IntersectionObserver(n,{rootMargin:"0px 0px 400px 0px",threshold:0});for(let o=0;o<t;o++){const l=e[o],a=lib.makeId();a&&(l.setAttribute("id",a),this.items[a]={el:l,page:1},this.observer.observe(l))}this._initialized=!0}}destroy(){typeof window>"u"||(this.observer&&(this.observer.disconnect(),this.observer=null),this.items={},this.locked=!1,this._initialized=!1)}reset(e){if(typeof document>"u")return;const t=lib.qs(e);if(!t||!t.id)return;const s=this.items[t.id];s&&(s.page=1)}}const loadmore=new Loadmore;class Sheets{constructor(){this._handlers=new Map,this._initialized=!1}_isValidSheetValue(e){return typeof e!="string"||!e?!1:/^[a-zA-Z0-9_-]+$/.test(e)}init(){this._initialized&&this.destroy();const e=lib.qsa("[x-sheets]");if(e.length){for(const t of e){if(!t)continue;const s=lib.qsa("[x-sheet-open]:not([x-sheet-open] [x-sheet-open])",t);for(const o of s){if(!o)continue;const l=o.getAttribute("x-sheet-open");if(!l){console.warn("sheets.init: Tab has x-sheet-open attribute but no value",o);continue}if(!this._isValidSheetValue(l)){console.error("sheets.init: Invalid sheet value (security check failed):",l);continue}const a=c=>{c.preventDefault(),this.show(l)};o.addEventListener("click",a),this._handlers.set(o,a)}const n=lib.qs("[x-sheet-open].active",t);if(n){const o=n.getAttribute("x-sheet-open");o&&this._isValidSheetValue(o)&&this.show(o)}}this._initialized=!0}}destroy(){for(const[e,t]of this._handlers.entries())e.removeEventListener("click",t);this._handlers.clear(),this._initialized=!1}show(e){if(!e||typeof e!="string"){console.error("sheets.show: Sheet value is required and must be a string");return}if(!this._isValidSheetValue(e)){console.error("sheets.show: Invalid sheet value (security check failed):",e);return}const t=CSS.escape(e),s=lib.qs(`[x-sheet="${t}"]`);if(!s){console.warn("sheets.show: Target content not found:",e);return}const n=s.closest("[x-sheets]");if(!n){console.warn("sheets.show: Sheets container not found for:",e);return}const o=lib.qs(`[x-sheet-open="${t}"]`,n);if(!o){console.warn("sheets.show: Tab not found:",e);return}if(o.classList.contains("active")&&s.classList.contains("active"))return;const l=lib.qsa("[x-sheet-open]",n),a=lib.qsa("[x-sheet]",n);for(const c of l)c&&c.classList.contains("active")&&c.classList.remove("active");for(const c of a)c&&c.classList.contains("active")&&c.classList.remove("active");o.classList.add("active"),s.classList.add("active")}}const sheets=new Sheets;class Dropdown{constructor(){this._handlers=new Map,this._menus=new Map,this._parentToMenu=new Map,this._initialized=!1,this._globalClickHandler=null}init(){if(typeof document>"u")return;this._initialized&&this._cleanup(),this._attachGlobalListeners();const e=lib.qsa("[x-dropdown]");for(const t of e){const s=t.parentElement;if(!s)continue;const n=lib.qs("[x-dropdown-open]",s);n&&(this._setupAccessibility(s,n,t),this._bindTrigger(s,n),this._bindMenuKeys(t,n,s),this._menus.set(t,{parent:s,trigger:n}),this._parentToMenu.set(s,t),s.dispatchEvent(new CustomEvent("dropdown:ready")))}this._initialized=!0}_setupAccessibility(e,t,s){e.classList.add("dropdown"),t.setAttribute("aria-expanded","false"),s.id||(s.id=lib.makeId()),t.setAttribute("aria-controls",s.id),s.setAttribute("role","menu"),s.setAttribute("tabindex","-1");const n=s.querySelectorAll("li > a");for(let o=0;o<n.length;o++){const l=n[o];l.setAttribute("role","menuitem"),l.setAttribute("tabindex","-1")}}_bindTrigger(e,t){const s=lib.throttle(()=>this._toggleDropdown(e,t),400),n=t.tagName,o=n==="INPUT"||n==="TEXTAREA";let l=null;const a=d=>{o||(d.stopPropagation(),s())},c=d=>{const{key:p}=d;if(!(p===" "&&o)){if(!o&&(p==="Enter"||p===" ")){d.preventDefault(),s();return}if(p==="ArrowDown"){d.preventDefault(),o||(this._open(e,t),this._focusFirstItem(e));return}p==="ArrowUp"&&(d.preventDefault(),o||(this._open(e,t),this._focusLastItem(e)))}},h=()=>{o?(l&&clearTimeout(l),this.closeAllDropdowns(),this._open(e,t)):t.classList.add("hover")},u=()=>{o?l=setTimeout(()=>this._close(e),200):t.classList.remove("hover")};this._handlers.set(t,{clickListener:a,keyListener:c,focusListener:h,blurListener:u,blurTimeout:l}),t.addEventListener("click",a),t.addEventListener("keydown",c),t.addEventListener("focus",h),t.addEventListener("blur",u)}_bindMenuKeys(e,t,s){const n=a=>{const c=e.querySelectorAll('[role="menuitem"]:not([disabled])'),h=c.length;if(!h)return;let u=-1;const d=document.activeElement;for(let b=0;b<h;b++)if(c[b]===d){u=b;break}const p=a.key;if(p==="ArrowDown"){a.preventDefault(),c[(u+1)%h].focus();return}if(p==="ArrowUp"){a.preventDefault(),c[(u-1+h)%h].focus();return}if(p==="Home"){a.preventDefault(),c[0].focus();return}if(p==="End"){a.preventDefault(),c[h-1].focus();return}p==="Escape"&&(a.preventDefault(),this._close(s),t.focus())},o=a=>{a.target.matches('[role="menuitem"]')&&a.target.classList.add("hover")},l=a=>{a.target.matches('[role="menuitem"]')&&a.target.classList.remove("hover")};this._handlers.set(e,{keyListener:n,focusListener:o,blurListener:l}),e.addEventListener("keydown",n),e.addEventListener("focusin",o),e.addEventListener("focusout",l)}_cleanup(){this.closeAllDropdowns(),this._handlers.forEach((e,t)=>{e.clickListener&&t.removeEventListener("click",e.clickListener),e.keyListener&&t.removeEventListener("keydown",e.keyListener),e.focusListener&&(t.removeEventListener("focus",e.focusListener),t.removeEventListener("focusin",e.focusListener)),e.blurListener&&(t.removeEventListener("blur",e.blurListener),t.removeEventListener("focusout",e.blurListener)),e.blurTimeout&&clearTimeout(e.blurTimeout)}),this._handlers.clear(),this._menus.clear(),this._parentToMenu.clear(),Dropdown._globalListenersAttached&&this._globalClickHandler&&(document.removeEventListener("click",this._globalClickHandler),Dropdown._globalListenersAttached=!1)}_toggleDropdown(e,t){const s=e.classList.contains("dropdown--open");this.closeAllDropdowns(),s||this._open(e,t)}async _open(e,t){const s=this._parentToMenu.get(e);s&&(this._fireEvent(e,"beforeshow"),this._adjustPosition(e,s),lib.addClass(t,"active"),lib.addClass(e,"dropdown--open",20),t.setAttribute("aria-expanded","true"),this._fireEvent(e,"aftershow"))}_adjustPosition(e,t){e.classList.add("dropdown--ready");const s=t.getBoundingClientRect();e.classList.remove("dropdown--ready");const n=window.innerWidth,o=document.documentElement.scrollHeight;e.classList.remove("dropdown--right","dropdown--bottom"),s.right>n&&e.classList.add("dropdown--right"),window.scrollY+s.bottom>o&&e.classList.add("dropdown--bottom")}_focusFirstItem(e){const t=this._parentToMenu.get(e);if(!t)return;const s=t.querySelector('[role="menuitem"]:not([disabled])');s&&s.focus()}_focusLastItem(e){const t=this._parentToMenu.get(e);if(!t)return;const s=t.querySelectorAll('[role="menuitem"]:not([disabled])');s.length&&s[s.length-1].focus()}closeAllDropdowns(){if(!document.querySelector(".dropdown--open"))return;const e=lib.qsa(".dropdown--open");for(const t of e)this._close(t)}async _close(e){if(e._dropdownClosing)return;e._dropdownClosing=!0,this._fireEvent(e,"beforehide");const t=lib.qs("[x-dropdown-open]",e);t&&(lib.removeClass(t,"active"),t.setAttribute("aria-expanded","false")),await lib.removeClass(e,"dropdown--open",200),e.classList.remove("dropdown--right","dropdown--bottom"),this._fireEvent(e,"afterhide"),setTimeout(()=>{e._dropdownClosing=!1},100)}_fireEvent(e,t){e.dispatchEvent(new CustomEvent(`dropdown:${t}`))}_attachGlobalListeners(){Dropdown._globalListenersAttached||(this._globalClickHandler=e=>{e.target.closest("[x-dropdown-open]")||e.target.closest("[x-dropdown] .dropdown--stay")||document.querySelector(".dropdown--open")&&this.closeAllDropdowns()},document.addEventListener("click",this._globalClickHandler),Dropdown._globalListenersAttached=!0)}destroy(){typeof document>"u"||!this._initialized||(this._cleanup(),this._initialized=!1)}}Dropdown._globalListenersAttached=!1;const dropdown=new Dropdown;class Autocomplete{constructor(){T(this,"emptyStateHtml",'<li><span class="op4">Ничего не найдено</span></li>');T(this,"defaultStateHtml",'<li><span class="op4">Начните печатать</span></li>');T(this,"loadingStateHtml",'<li><span class="op4">Загрузка...</span></li>');this._clicked=!1,this._currentLoadId=0,this._loadData=this._loadData.bind(this),this._keyHandler=this._keyHandler.bind(this),this._clickHandler=this._clickHandler.bind(this),this._hideHandler=this._hideHandler.bind(this)}init(e,t={}){typeof window>"u"||!e||typeof e!="string"||(this.emptyStateHtml=t.emptyStateHtml??this.emptyStateHtml,this.defaultStateHtml=t.defaultStateHtml??this.defaultStateHtml,this.loadingStateHtml=t.loadingStateHtml??this.loadingStateHtml,this.dropdown=lib.id(e),this.dropdown&&(this.field=lib.qs("[x-dropdown-open]",this.dropdown),this.list=lib.qs("[x-dropdown]",this.dropdown),!(!this.field||!this.list)&&(this.data=t.data??null,this.loadData=t.loadData??null,this.mapData=t.mapData??null,this.renderItem=t.renderItem??null,this.onSelect=t.onSelect??null,this.resetFunc=t.resetFunc??null,this.debouncedLoadData=lib.debounce(this._loadData,400),this.field.value.trim()?this._defaultState():this._reset(),this.field.addEventListener("focus",this.debouncedLoadData),this.field.addEventListener("input",this.debouncedLoadData),this.field.addEventListener("keydown",this._keyHandler),this.list.addEventListener("click",this._clickHandler),this.dropdown.addEventListener("dropdown:afterhide",this._hideHandler))))}destroy(){typeof window>"u"||!this.field||!this.list||!this.dropdown||(this._reset(),this.field.removeEventListener("focus",this.debouncedLoadData),this.field.removeEventListener("input",this.debouncedLoadData),this.field.removeEventListener("keydown",this._keyHandler),this.list.removeEventListener("click",this._clickHandler),this.dropdown.removeEventListener("dropdown:afterhide",this._hideHandler))}_keyHandler(e){var t;e.key==="Enter"&&(e.preventDefault(),(t=this.field)==null||t.blur())}_clickHandler(e){if(this._clicked)return;this._clicked=!0;const t=e.target.closest("[data-item]");if(!t||!this.onSelect){setTimeout(()=>{this._clicked=!1},0);return}try{const s=JSON.parse(t.dataset.item);this.onSelect(s)}catch(s){console.error("Autocomplete: error parsing data-item JSON",s)}setTimeout(()=>{this._clicked=!1},0)}_hideHandler(){var e;if(this._clicked){this._clicked=!1;return}if(!((e=this.data)!=null&&e.length)||!this.onSelect){this._reset();return}this._loadingState(),this.onSelect(this.data[0])}_loadingState(){lib.render(this.list,this.loadingStateHtml)}_emptyState(){lib.render(this.list,this.emptyStateHtml)}_defaultState(){lib.render(this.list,this.defaultStateHtml)}_reset(){this.resetFunc&&this.resetFunc(),this.data=null,this._defaultState()}async _loadData(){if(!this.field||!this.field.value.trim()){this._reset();return}if(!this.loadData){this._defaultState();return}this._loadingState();const e=Date.now();this._currentLoadId=e;try{const t=await this.loadData(this);if(e!==this._currentLoadId)return;this.data=this.mapData?this.mapData(t):t,this.render()}catch(t){e===this._currentLoadId&&this._reset(),console.error("Autocomplete: load error",t)}}render(){if(!this.data){this._reset();return}if(!this.data.length){this._emptyState();return}if(!this.renderItem){this._defaultState();return}const e=this.data.map(this.renderItem).join("");lib.render(this.list,e)}}const autocomplete=new Autocomplete;class Scroll{constructor(){this.parent=window,this.offset=0,this.classActive="active",this.hash=!1,this.to=this.scrollTo,this._linksHash={},this._scrollHandlers=new Map,this._initialized=!1}_isValidSelector(e){return typeof e!="string"||!e||/<script|javascript:/i.test(e)?!1:/^[#.a-zA-Z0-9_\-\[\]="':\s>+~,()]+$/.test(e)}init(){this._initialized&&this.destroy();const e=lib.qsa("[x-scrollto]");if(e.length){this._linksHash={};for(const t of e)if(t)try{const s=t.getAttribute("x-scrollto");if(!s){console.warn("scroll.init: Link has x-scrollto attribute but no value",t);continue}let n={};if(lib.isValidJSON(s)){const o=JSON.parse(s);if(!o||typeof o!="object"){console.error("scroll.init: Invalid JSON object:",o);continue}const l=o.target;if(!l){console.error("scroll.init: Target required in JSON:",o);continue}if(typeof l!="string"||!this._isValidSelector(l)){console.error("scroll.init: Invalid or unsafe selector:",l);continue}const a=lib.qs(l);if(!a){console.error("scroll.init: Target element not found:",l);continue}if(n.link=t,n.target=a,n.offset=typeof o.offset=="number"?o.offset:this.offset,n.classActive=o.classActive||this.classActive,n.hash=o.hash??this.hash,o.parent)if(typeof o.parent=="string")if(!this._isValidSelector(o.parent))console.error("scroll.init: Invalid parent selector:",o.parent),n.parent=this.parent;else{const c=lib.qs(o.parent);n.parent=c||this.parent}else o.parent instanceof HTMLElement||o.parent===window?n.parent=o.parent:n.parent=this.parent;else n.parent=this.parent}else{if(!this._isValidSelector(s)){console.error("scroll.init: Invalid or unsafe selector:",s);continue}const o=lib.qs(s);if(!o){console.error("scroll.init: Target not found:",s);continue}n.link=t,n.parent=this.parent,n.target=o,n.offset=this.offset,n.classActive=this.classActive,n.hash=this.hash}if(n.link&&n.target){const o=lib.makeId();if(!o){console.error("scroll.init: Failed to generate ID");continue}this._linksHash[o]=n,t.addEventListener("click",l=>{l.preventDefault(),this.scrollTo({parent:n.parent,target:n.target,offset:n.offset,classActive:n.classActive,hash:n.hash})})}}catch(s){console.error("scroll.init: Error processing link",t,s)}Object.keys(this._linksHash).length&&this._setupScrollObservers(),this._initialized=!0}}destroy(){for(const[e,t]of this._scrollHandlers.entries())e.removeEventListener("scroll",t);this._scrollHandlers.clear(),this._linksHash={},this._initialized=!1}_isValidId(e){return typeof e!="string"||!e?!1:/^[a-zA-Z0-9_-]+$/.test(e)}async scrollTo(e){return new Promise(t=>{if(!e){console.error("scroll.scrollTo: Parameters required"),t();return}let s,n,o,l;if(e instanceof HTMLElement)s=e,n=this.parent,o=this.offset,l=this.hash;else if(typeof e=="string"){if(!this._isValidSelector(e)){console.error("scroll.scrollTo: Invalid or unsafe selector:",e),t();return}s=lib.qs(e),n=this.parent,o=this.offset,l=this.hash}else if(typeof e=="object"){if(e.target instanceof HTMLElement)s=e.target;else if(typeof e.target=="string"){if(!this._isValidSelector(e.target)){console.error("scroll.scrollTo: Invalid or unsafe target selector:",e.target),t();return}s=lib.qs(e.target)}else{console.error("scroll.scrollTo: Invalid target parameter:",e.target),t();return}e.parent===window||e.parent instanceof HTMLElement?n=e.parent:typeof e.parent=="string"?this._isValidSelector(e.parent)?n=lib.qs(e.parent)||this.parent:(console.error("scroll.scrollTo: Invalid or unsafe parent selector:",e.parent),n=this.parent):n=this.parent,o=typeof e.offset=="number"?e.offset:this.offset,l=e.hash??this.hash}else{console.error("scroll.scrollTo: Invalid parameters:",e),t();return}if(!s){console.error("scroll.scrollTo: Target not found:",e),t();return}if(!n){console.error("scroll.scrollTo: Parent not found"),t();return}let a,c,h,u;try{n===window?(c=window.pageYOffset||window.scrollY,a=c+s.getBoundingClientRect().top,u=a-c-o):(c=n.scrollTop,h=n.getBoundingClientRect().top,a=c+s.getBoundingClientRect().top-h,u=a-c-o),n.scrollTo({top:Math.max(0,c+u),left:0,behavior:"smooth"}),setTimeout(t,400),l&&s.id?this._isValidId(s.id)?lib.updateURL("#"+s.id):console.warn("scroll.scrollTo: Invalid target ID for hash:",s.id):l&&history.replaceState({},document.title,window.location.href.split("#")[0])}catch(d){console.error("scroll.scrollTo: Error during scroll",d),t()}})}_setupScrollObservers(){const e=new Set;for(const t in this._linksHash)e.add(this._linksHash[t].parent);for(const t of e){const s=t===window?window:lib.qs(t);if(!s)continue;const n=()=>{this._scrollObserve()};s.addEventListener("scroll",n,{passive:!0}),this._scrollHandlers.set(s,n)}this._scrollObserve()}_scrollObserve(){const e=document.documentElement.clientHeight/4;for(const t in this._linksHash){if(!this._linksHash.hasOwnProperty(t))continue;const s=this._linksHash[t];if(!(!s||!s.target||!s.link))try{const n=s.target.getBoundingClientRect(),o=n.top<=e&&n.bottom>e;s.classActive!=null&&(o?(s.link.classList.contains(s.classActive)||s.link.classList.add(s.classActive),s.target.classList.contains(s.classActive)||s.target.classList.add(s.classActive)):(s.link.classList.contains(s.classActive)&&s.link.classList.remove(s.classActive),s.target.classList.contains(s.classActive)&&s.target.classList.remove(s.classActive)))}catch(n){console.error("scroll._scrollObserve: Error observing item",t,n)}}}}const scroll=new Scroll;class Hover{constructor(){this._initialized=!1,this._boundEnter=this._handleEnter.bind(this),this._boundLeave=this._handleLeave.bind(this)}init(){typeof document>"u"||this._initialized||(this._initialized=!0,document.addEventListener("mouseenter",this._boundEnter,!0),document.addEventListener("mouseleave",this._boundLeave,!0))}destroy(){typeof document>"u"||!this._initialized||(document.removeEventListener("mouseenter",this._boundEnter,!0),document.removeEventListener("mouseleave",this._boundLeave,!0),this._initialized=!1)}_handleEnter(e){this._syncHover(e,!0)}_handleLeave(e){this._syncHover(e,!1)}_syncHover(e,t){const s=e==null?void 0:e.target;if(!s||typeof s.closest!="function")return;const n=s.closest("[x-hover]");if(!n)return;const o=n.getAttribute("href");if(!(o==null||o.trim()==="")&&!(typeof CSS>"u"||typeof CSS.escape!="function"))try{const l=CSS.escape(o),a=lib.qsa(`[x-hover][href="${l}"]`);for(let c=0;c<a.length;c++)a[c].classList.toggle("hover",t)}catch{}}}const hover=new Hover,CLASSES_TO_REMOVE=["js","windows","macos","ios","android","linux","unknown","chrome","firefox","safari","opera","edge","iphone","ipad","mac","computer","mobile","desktop","touch"],SIZE_FLAGS={s:{s:!0,m:!1,l:!1,xl:!1},m:{s:!1,m:!0,l:!1,xl:!1},l:{s:!1,m:!1,l:!0,xl:!1},xl:{s:!1,m:!1,l:!1,xl:!0}};class Device{constructor(){this.js=!0,this.os="unknown",this.browser="unknown",this.device=null,this.mobile=!1,this.touch=!1,this.width=0,this.height=0,this.breakpoint="s",this.size=SIZE_FLAGS.s,this._html=null,this._onResize=this._onResize.bind(this),this._debouncedResize=lib.debounce(this._onResize,200),this._initialized=!1,!(typeof window>"u")&&(this.width=window.innerWidth,this.height=window.innerHeight,this.breakpoint=this._getBreakpointName(this.width),this.size=SIZE_FLAGS[this.breakpoint]||SIZE_FLAGS.s,this._html=document.documentElement)}init(){typeof window>"u"||(this._initialized&&this._cleanup(),this._html=document.documentElement,this._detect(),this._applyHtmlClasses(),window.addEventListener("resize",this._debouncedResize),this._initialized=!0)}destroy(){typeof window>"u"||this._cleanup()}_cleanup(){window.removeEventListener("resize",this._debouncedResize),this._html&&this._html.classList.remove(...CLASSES_TO_REMOVE),this._initialized=!1}_getBreakpointName(e){return e>=1400?"xl":e>=1e3?"l":e>=600?"m":"s"}_getSizeFlags(e){return SIZE_FLAGS[e]||SIZE_FLAGS.s}_onResize(){const e=window.innerWidth,t=window.innerHeight,s=this.breakpoint,n=this._getBreakpointName(e);this.width=e,this.height=t,this.breakpoint=n,this.size=SIZE_FLAGS[n]||SIZE_FLAGS.s,s!==n&&window.dispatchEvent(new CustomEvent("breakpointchange",{detail:{prev:s,current:n,width:e,height:t}}))}_detect(){var t;const e=window.navigator.userAgent.toLowerCase();this.mobile=/mobile/.test(e),e.includes("win")?this.os="windows":e.includes("iphone")||e.includes("ipad")||e.includes("ipod")?this.os="ios":e.includes("android")?this.os="android":e.includes("mac")?this.os="macos":e.includes("linux")?this.os="linux":this.os="unknown",/edg\//.test(e)?this.browser="edge":/opr\//.test(e)||/opera/.test(e)?this.browser="opera":/firefox/.test(e)?this.browser="firefox":/chrome/.test(e)?this.browser="chrome":/safari/.test(e)?this.browser="safari":this.browser="unknown",e.includes("ipad")?this.device="ipad":e.includes("iphone")?this.device="iphone":e.includes("android")?this.device="android":e.includes("mac")?this.device="mac":this.device="computer",this.touch=((t=window.matchMedia)==null?void 0:t.call(window,"(pointer: coarse)").matches)??!1}_applyHtmlClasses(){if(!this._html)return;const e=["js",this.os,this.browser,this.device,this.mobile?"mobile":"desktop",this.touch?"touch":null].filter(Boolean);this._html.classList.add(...e)}}const device=new Device;class Form{constructor(){this._updateElements=new Set,this._updateHandlers=new Map,this.listen=Object.freeze({update:this._updateElements})}getEventType(e){var s;if(!e)throw new Error("getEventType: Element is required");if(e.isContentEditable)return"input";const t=(s=e.tagName)==null?void 0:s.toLowerCase();if(!t)throw new Error("getEventType: Element has no tagName");if(t==="input"||t==="textarea")return"input";if(t==="select")return"change";throw new Error(`getEventType: Unsupported element <${t}>`)}_eventType(e){var s;if(!e)return"";if(e.isContentEditable)return"input";const t=(s=e.tagName)==null?void 0:s.toLowerCase();return t==="input"||t==="textarea"?"input":t==="select"?"change":""}setChecked(e,t=!1){if(typeof document>"u"||!e)return;const s=lib.qsa(e);for(let n=0;n<s.length;n++){const o=s[n],l=o.type;l!=="checkbox"&&l!=="radio"||o.checked!==t&&(o.checked=t,o.dispatchEvent(new Event("input",{bubbles:!0})))}}setValue(e,t){var o;if(typeof document>"u"||!e)return;const s=lib.qsa(e),n=String(t);for(let l=0;l<s.length;l++){const a=s[l];let c="";try{if(a.isContentEditable)a.innerText=n,c="input";else{const h=(o=a.tagName)==null?void 0:o.toLowerCase();if(!h)continue;const u=a.type;if(h==="input")u==="checkbox"||u==="radio"?a.checked=!!t:a.value=n,c="input";else if(h==="textarea"||h==="select")a.value=n,c=h==="select"?"change":"input";else continue}c&&a.dispatchEvent(new Event(c,{bubbles:!0}))}catch(h){typeof console<"u"&&console.error&&console.error("setValue",a,h)}}}onUpdate(e,t){if(typeof document>"u"||!e||typeof t!="function")return;const s=lib.qsa(e);for(let n=0;n<s.length;n++){const o=s[n];if(this._updateHandlers.has(o))continue;const l=this._eventType(o);if(!l)continue;const a=()=>t(o);o.addEventListener(l,a),this._updateHandlers.set(o,{eventType:l,handler:a}),this._updateElements.add(o)}}offUpdate(e){if(typeof document>"u"||!e)return;const t=lib.qsa(e);for(let s=0;s<t.length;s++){const n=t[s],o=this._updateHandlers.get(n);o&&(n.removeEventListener(o.eventType,o.handler),this._updateHandlers.delete(n),this._updateElements.delete(n))}}update(e){if(typeof document>"u"||!e)return;const t=lib.qsa(e);for(let s=0;s<t.length;s++){const n=t[s],o=this._eventType(n);o&&n.dispatchEvent(new Event(o,{bubbles:!0}))}}destroy(){typeof document>"u"||(this._updateHandlers.forEach((e,t)=>{t.removeEventListener(e.eventType,e.handler)}),this._updateHandlers.clear(),this._updateElements.clear())}}const form=new Form;class Sticky{constructor(){this.activeClass="sticky_on",this.rootMargin="-1px 0px 0px 0px",this._observer=null,this._initialized=!1,this._initObserver()}_initObserver(){if(!("IntersectionObserver"in window)){console.warn("sticky: IntersectionObserver is not supported");return}this._observer=new IntersectionObserver(e=>{for(const t of e)t&&t.target&&this._handleEntry(t)},{threshold:1,rootMargin:this.rootMargin})}_handleEntry(e){if(!e||!e.target)return;const t=e.target;if(!(t instanceof HTMLElement))return;const s=e.intersectionRatio<1,n=t.classList.contains(this.activeClass);s!==n&&(s?(t.classList.add(this.activeClass),t.dispatchEvent(new CustomEvent("sticky:on",{bubbles:!0}))):(t.classList.remove(this.activeClass),t.dispatchEvent(new CustomEvent("sticky:off",{bubbles:!0}))))}init(){if(!this._observer){console.warn("sticky.init: IntersectionObserver is not available");return}this._initialized&&this.reset();const e=lib.qsa(".sticky");for(const t of e)if(!(!t||!(t instanceof HTMLElement))&&!t.dataset.stickyObserved)try{this._observer.observe(t),t.dataset.stickyObserved="true"}catch(s){console.error("sticky.init: Error observing element",t,s)}this._initialized=!0}reset(){if(!this._observer)return;const e=lib.qsa(".sticky");for(const t of e)if(!(!t||!(t instanceof HTMLElement))&&t.dataset.stickyObserved)try{document.body.contains(t)&&this._observer.unobserve(t),delete t.dataset.stickyObserved}catch(s){console.error("sticky.reset: Error unobserving element",t,s),delete t.dataset.stickyObserved}}destroy(){this._observer&&(this._observer.disconnect(),this._observer=null),this._initialized=!1}}const sticky=new Sticky;class Slider{constructor(){this.sliders=[],this.instances=new Map,this.io=null,this.mo=null}init(){if(this.observeSliders(),!("MutationObserver"in window)){console.warn("slider: MutationObserver is not supported");return}this.mo=new MutationObserver(e=>{var t;for(const s of e)for(const n of s.addedNodes)if(n.nodeType===1&&n instanceof HTMLElement){n.hasAttribute("x-slider")&&this.io&&this.io.observe(n);const o=(t=n.querySelectorAll)==null?void 0:t.call(n,"[x-slider]");if(o&&this.io)for(const l of o)l&&!this.instances.has(l)&&this.io.observe(l)}}),this.mo.observe(document.body,{childList:!0,subtree:!0})}destroy(){this.instances.forEach((e,t)=>{const s=e.listenerTarget||e.wrapper||t;e.touch?(s.removeEventListener("touchstart",e.events.touchstart,!0),s.removeEventListener("touchmove",e.events.touchmove,!0),s.removeEventListener("touchend",e.events.touchend,!0),s.removeEventListener("touchcancel",e.events.touchcancel,!0)):(t.removeEventListener("mousemove",e.events.mousemove),e.events.mouseout&&t.removeEventListener("mouseleave",e.events.mouseout),e.events.mouseenter&&t.removeEventListener("mouseenter",e.events.mouseenter),e.events.resize&&(window.removeEventListener("resize",e.events.resize),window.removeEventListener("orientationchange",e.events.resize)))}),this.io&&this.io.disconnect(),this.mo&&this.mo.disconnect(),this.instances.clear()}observeSliders(){if(!("IntersectionObserver"in window)){console.warn("slider: IntersectionObserver is not supported");return}this.sliders=document.querySelectorAll("[x-slider]"),this.io=new IntersectionObserver(e=>{for(const t of e)t.isIntersecting&&t.target&&!this.instances.has(t.target)&&this.initSlider(t.target)},{rootMargin:"60px 0px 60px 0px",threshold:0});for(const e of this.sliders)e&&this.io.observe(e)}_validateConfig(e){const t={gap:0,rubber:!0,resetOnMouseout:!0,touch:!0};if(!e||typeof e!="object")return t;if("gap"in e){const s=Number(e.gap);t.gap=isNaN(s)||s<0?0:s}return"rubber"in e&&(t.rubber=!!e.rubber),"resetOnMouseout"in e&&(t.resetOnMouseout=!!e.resetOnMouseout),"touch"in e&&(t.touch=!!e.touch),t}initSlider(e){if(!e||!(e instanceof HTMLElement)){console.error("slider.initSlider: Invalid element");return}const t=[...e.children].map(m=>m.cloneNode(!0));if(!t.length){console.warn("slider.initSlider: No slides found",e);return}e.classList.add("slider"),e.style.overflow="hidden",e.style.overscrollBehavior="contain";let s=0,n=!0,o=!0,l=!0;try{const m=e.getAttribute("x-slider");if(m)if(!lib.isValidJSON(m))console.warn("slider.initSlider: Invalid JSON in x-slider attribute:",m);else{const v=JSON.parse(m),f=this._validateConfig(v);s=f.gap,n=f.rubber,o=f.resetOnMouseout,l=f.touch}}catch(m){console.warn("slider.initSlider: Error parsing x-slider JSON",m)}const a=document.createElement("div");a.className="slider-wrapper",a.style.gap=s+"px",e.innerHTML="";for(let m=0;m<t.length;m++){const v=t[m];if(!v)continue;v.classList.add("slider-item");const f=v.querySelector("img");f&&m===0&&(f.dataset.srcset&&(f.srcset=f.dataset.srcset,f.removeAttribute("data-srcset")),f.dataset.src&&(f.src=f.dataset.src,f.removeAttribute("data-src")),f.setAttribute("loading","eager")),a.appendChild(v)}e.appendChild(a);const c="ontouchstart"in window;let h=[];if(t.length>1&&(!c||l)){const m=document.createElement("div");m.className="slider-indicators";for(let v=0;v<t.length;v++){const f=document.createElement("span");v===0&&f.classList.add("active"),m.appendChild(f)}e.appendChild(m),h=[...m.querySelectorAll("span")]}const u=t;if(c&&l?e.classList.add("slider_touch"):e.classList.remove("slider_touch"),c&&!l){u[0].classList.add("active");return}let d=0;const p=/iP(ad|hone|od)/.test(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,b=()=>u[0].offsetWidth+s,E=(m,v=!1)=>{const f=Math.max(0,Math.min(m,u.length-1)),g=b();if(d=f,a.style.transition=v?"none":"transform 0.25s",a.style.transform=`translateX(${-d*g}px)`,h.length)for(let w=0;w<h.length;w++){const S=h[w];S&&S.classList.toggle("active",w===d)}v||a.addEventListener("transitionend",()=>{a.style.transition="none",p&&(a.style.pointerEvents="none",requestAnimationFrame(()=>{a.offsetWidth,a.style.pointerEvents="auto"}))},{once:!0})};E(0,!0);const _={};let C=!1,A=null;const I=()=>{if(!C){C=!0;for(let m=0;m<u.length;m++){const v=u[m];if(!v)continue;const f=v.querySelector("img");!f||m===0||(f.dataset.srcset&&(f.srcset=f.dataset.srcset,f.removeAttribute("data-srcset")),f.dataset.src&&(f.src=f.dataset.src,f.removeAttribute("data-src")),!c&&(!f.complete||f.naturalWidth===0)&&f.addEventListener("load",()=>{if(A!=null){const g=e.getBoundingClientRect(),w=e.offsetWidth;w>0&&Math.floor((A-g.left)/w*u.length)===m&&E(m,!0)}},{once:!0}))}}};if(u.length>1)if(c){let m=0,v=0,f=!1,g=null;const w=(y,k)=>[...y].find(L=>L.identifier===k)||null,S=()=>{I(),e.removeEventListener("touchstart",S)};e.addEventListener("touchstart",S,{passive:!1,capture:!0}),_.touchstart=y=>{const k=y.changedTouches[0];g=k.identifier,m=k.clientX,v=k.clientY,f=!0,a.style.transition="none"},_.touchmove=y=>{if(!f||g==null)return;const k=w(y.touches,g);if(!k)return;const L=k.clientX-m,O=k.clientY-v;if(Math.abs(O)>Math.abs(L))return;y.cancelable&&y.preventDefault();const M=b();let H=L;d===0&&L>0&&(H=n?L*.15:0),d===u.length-1&&L<0&&(H=n?L*.15:0),a.style.transform=`translateX(${-d*M+H}px)`},_.touchend=y=>{if(!f)return;f=!1;const k=w(y.changedTouches,g)||y.changedTouches[0];g=null;const L=k.clientX-m,O=k.clientY-v,H=b()*.1;if(Math.abs(O)>Math.abs(L)){E(d);return}if(d===0&&L>0||d===u.length-1&&L<0){E(d);return}L>H&&d>0?E(d-1):L<-H&&d<u.length-1?E(d+1):E(d)},_.touchcancel=()=>{f=!1,g=null,E(d)},e.addEventListener("touchstart",_.touchstart,{passive:!1,capture:!0}),e.addEventListener("touchmove",_.touchmove,{passive:!1,capture:!0}),e.addEventListener("touchend",_.touchend,{capture:!0}),e.addEventListener("touchcancel",_.touchcancel,{capture:!0})}else{const m=v=>{A=v.clientX,I(),e.removeEventListener("mouseenter",m)};e.addEventListener("mouseenter",m),_.mousemove=v=>{A=v.clientX;const f=e.getBoundingClientRect(),g=e.offsetWidth;if(g<=0)return;let w=v.clientX-f.left;w<0?w=0:w>=g&&(w=g-1e-7);const S=Math.floor(w/g*u.length),y=u[S].querySelector("img");S!==d&&(!y||y.complete||y.naturalWidth>0)&&E(S,!0)},e.addEventListener("mousemove",_.mousemove),e.addEventListener("mouseenter",v=>_.mousemove(v)),o&&(_.mouseout=()=>E(0,!0),e.addEventListener("mouseleave",_.mouseout))}const q=()=>{const m=b();a.style.transition="none",a.style.transform=`translateX(${-d*m}px)`};window.addEventListener("resize",q),window.addEventListener("orientationchange",q),_.resize=q,this.instances.set(e,{wrapper:a,slides:u,events:_,touch:c,listenerTarget:e})}}const slider=new Slider;class X{constructor(){this.modal=modal,this.animate=animate,this.appear=appear,this.lazyload=lazyload,this.loadmore=loadmore,this.sheets=sheets,this.dropdown=dropdown,this.autocomplete=autocomplete,this.scroll=scroll,this.hover=hover,this.device=device,this.lib=lib,this.render=lib.render.bind(lib),this.form=form,this.sticky=sticky,this.slider=slider,this.initialized=!1}init(){this.initialized||(this.device.init(),this.modal.init(),this.animate.init(),this.appear.init(),this.lazyload.init(),this.loadmore.init(),this.sheets.init(),this.dropdown.init(),this.scroll.init(),this.sticky.init(),this.slider.init(),hover.init(),this.initialized=!0)}}const x=new X;window.x=x;window.qs=x.lib.qs;window.qsa=x.lib.qsa;window.x.id=x.lib.id;window.x.qs=x.lib.qs;window.x.qsa=x.lib.qsa;
